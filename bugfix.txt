fixed a bug with user authentication